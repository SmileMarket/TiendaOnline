<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SmileMarket</title>
  <!-- Tu CSS queda igual (omitido para no duplicar) -->
  <style>
    /* Tu código de estilos CSS aquí, igual al anterior... */
  </style>
</head>
<body>
  <header>
    <img src="img/Logo.jpg" alt="Logo SmileMarket" />
  </header>
  <h1>SmileMarket - Productos</h1>
  <div class="productos" id="productos-container"></div>

  <!-- Carrito flotante -->
  <div id="carrito">
    <h2>Carrito</h2>
    <div id="carrito-items"></div>
    <div id="total">Total: $0</div>
    <button id="confirmar">Confirmar compra</button>
  </div>

  <div id="popup">Producto agregado al carrito</div>

  <!-- Ícono flotante de WhatsApp -->
  <a href="https://wa.me/5491130335334?text=¡Hola!%20Tengo%20una%20consulta" 
     class="whatsapp-float" 
     target="_blank" 
     title="Escribinos por WhatsApp">
    💬
  </a>

  <!-- Importar productos desde archivo externo -->
  <script src="productos.js"></script>

  <!-- Script para mostrar productos y carrito -->
  <script>
    const contenedor = document.getElementById('productos-container');
    const carrito = [];

    function mostrarProductos() {
      productos.forEach(producto => {
        const div = document.createElement('div');
        div.className = 'producto';
        div.setAttribute('data-nombre', producto.nombre);
        div.setAttribute('data-precio', producto.precio);

        div.innerHTML = `
          ${producto.imagen ? `<img src="${producto.imagen}" alt="${producto.nombre}" />` : ''}
          <h3>${producto.nombre}</h3>
          <p class="precio">$ ${producto.precio.toLocaleString("es-AR")},00</p>
          <input class="cantidad-input" type="number" value="1" min="1" />
          <button class="boton" onclick="agregarAlCarrito(this)">Agregar al carrito</button>
        `;

        contenedor.appendChild(div);
      });
    }

    function agregarAlCarrito(boton) {
      const productoDiv = boton.closest('.producto');
      const nombre = productoDiv.dataset.nombre;
      const precio = parseFloat(productoDiv.dataset.precio);
      const cantidad = parseInt(productoDiv.querySelector('.cantidad-input').value);

      const existente = carrito.find(item => item.nombre === nombre);
      if (existente) {
        existente.cantidad += cantidad;
      } else {
        carrito.push({ nombre, precio, cantidad });
      }

      mostrarPopup();
      actualizarCarrito();
    }

    function eliminarDelCarrito(index) {
      carrito.splice(index, 1);
      actualizarCarrito();
    }

    function actualizarCarrito() {
      const carritoItems = document.getElementById('carrito-items');
      carritoItems.innerHTML = '';
      let total = 0;

      carrito.forEach((item, index) => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'carrito-item';
        itemDiv.innerHTML = `
          <div>${item.nombre} x ${item.cantidad}</div>
          <div>$${(item.precio * item.cantidad).toLocaleString()}</div>
          <button onclick="eliminarDelCarrito(${index})">&times;</button>
        `;
        carritoItems.appendChild(itemDiv);
        total += item.precio * item.cantidad;
      });

      document.getElementById('total').textContent = 'Total: $' + total.toLocaleString();
    }

    function mostrarPopup() {
      const popup = document.getElementById('popup');
      popup.style.display = 'block';
      setTimeout(() => {
        popup.style.display = 'none';
      }, 1000);
    }

    document.getElementById('confirmar').addEventListener('click', () => {
      if (carrito.length === 0) {
        alert('Tu carrito está vacío.');
        return;
      }

      let mensaje = 'Hola! Quiero realizar una compra:%0A';
      carrito.forEach(item => {
        mensaje += `• ${item.nombre} x ${item.cantidad} - $${(item.precio * item.cantidad).toLocaleString()}%0A`;
      });

      const total = carrito.reduce((sum, item) => sum + item.precio * item.cantidad, 0);
      mensaje += `%0ATotal: $${total.toLocaleString()}`;

      const numeroWhatsApp = '5491130335334';
      const url = `https://wa.me/${numeroWhatsApp}?text=${mensaje}`;
      window.open(url, '_blank');
    });

    // Ejecutar al cargar
    mostrarProductos();
  </script>
</body>
</html>